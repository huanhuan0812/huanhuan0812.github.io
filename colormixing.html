<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>油画颜料混合计算器</title>
    <style>
        body {
            font-family: 'Arial', sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        h1 {
            text-align: center;
            color: #444;
        }
        .container {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .color-picker {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .color-box {
            width: 45%;
            text-align: center;
        }
        input[type="color"] {
            width: 100px;
            height: 100px;
            border: none;
            cursor: pointer;
        }
        .slider-container {
            margin: 15px 0;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="range"] {
            width: 100%;
        }
        .result {
            margin-top: 30px;
            padding: 20px;
            border-radius: 8px;
            background-color: #f0f0f0;
            text-align: center;
        }
        .mixed-color {
            width: 150px;
            height: 150px;
            margin: 0 auto;
            border: 1px solid #ccc;
            border-radius: 8px;
        }
        .color-info {
            margin-top: 15px;
        }
        .hex-input {
            margin-top: 10px;
            padding: 5px;
            width: 80px;
            text-align: center;
        }
        .hex-input-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 5px;
        }
        .hex-input-container span {
            font-weight: bold;
        }
        .error-message {
            color: red;
            font-size: 12px;
            margin-top: 5px;
            height: 15px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>油画颜料混合计算器</h1>
        
        <div class="color-picker">
            <div class="color-box">
                <h3>颜料1</h3>
                <input type="color" id="color1" value="#ff0000">
                <div class="hex-input-container">
                    <span>#</span>
                    <input type="text" class="hex-input" id="hex1" value="ff0000" maxlength="6">
                </div>
                <div class="error-message" id="error1"></div>
                <div class="slider-container">
                    <label for="ratio1">混合比例:</label>
                    <input type="range" id="ratio1" min="0" max="100" value="50">
                    <span id="ratio1-value">50%</span>
                </div>
            </div>
            
            <div class="color-box">
                <h3>颜料2</h3>
                <input type="color" id="color2" value="#0000ff">
                <div class="hex-input-container">
                    <span>#</span>
                    <input type="text" class="hex-input" id="hex2" value="0000ff" maxlength="6">
                </div>
                <div class="error-message" id="error2"></div>
                <div class="slider-container">
                    <label for="ratio2">混合比例:</label>
                    <input type="range" id="ratio2" min="0" max="100" value="50">
                    <span id="ratio2-value">50%</span>
                </div>
            </div>
        </div>
        
        <div class="result">
            <h2>混合结果</h2>
            <div class="mixed-color" id="mixed-color"></div>
            <div class="color-info">
                <p>RGB: <span id="rgb-value"></span></p>
                <p>HEX: <span id="hex-value"></span></p>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const color1 = document.getElementById('color1');
            const color2 = document.getElementById('color2');
            const hex1 = document.getElementById('hex1');
            const hex2 = document.getElementById('hex2');
            const error1 = document.getElementById('error1');
            const error2 = document.getElementById('error2');
            const ratio1 = document.getElementById('ratio1');
            const ratio2 = document.getElementById('ratio2');
            const ratio1Value = document.getElementById('ratio1-value');
            const ratio2Value = document.getElementById('ratio2-value');
            const mixedColor = document.getElementById('mixed-color');
            const rgbValue = document.getElementById('rgb-value');
            const hexValue = document.getElementById('hex-value');
            
            // 同步滑块值显示
            function updateSliders() {
                ratio1Value.textContent = ratio1.value + '%';
                ratio2.value = 100 - ratio1.value;
                ratio2Value.textContent = ratio2.value + '%';
                calculateMixedColor();
            }
            
            ratio1.addEventListener('input', updateSliders);
            ratio2.addEventListener('input', function() {
                ratio2Value.textContent = this.value + '%';
                ratio1.value = 100 - this.value;
                ratio1Value.textContent = ratio1.value + '%';
                calculateMixedColor();
            });
            
            // 颜色选择器变化时更新HEX输入框
            color1.addEventListener('input', function() {
                hex1.value = color1.value.substring(1);
                error1.textContent = '';
                calculateMixedColor();
            });
            
            color2.addEventListener('input', function() {
                hex2.value = color2.value.substring(1);
                error2.textContent = '';
                calculateMixedColor();
            });
            
            // HEX输入框变化时更新颜色选择器
            function validateHexInput(input, errorElement, colorPicker) {
                const value = input.value;
                if (/^[0-9A-Fa-f]{6}$/.test(value)) {
                    colorPicker.value = '#' + value;
                    errorElement.textContent = '';
                    return true;
                } else if (value.length === 6) {
                    errorElement.textContent = '请输入有效的16进制颜色值';
                    return false;
                }
                return false;
            }
            
            hex1.addEventListener('input', function() {
                if (validateHexInput(hex1, error1, color1)) {
                    calculateMixedColor();
                }
            });
            
            hex2.addEventListener('input', function() {
                if (validateHexInput(hex2, error2, color2)) {
                    calculateMixedColor();
                }
            });
            
            // 计算混合颜色
            function calculateMixedColor() {
                // 确保两个颜色都是有效的
                const color1Valid = /^#[0-9A-Fa-f]{6}$/.test(color1.value);
                const color2Valid = /^#[0-9A-Fa-f]{6}$/.test(color2.value);
                
                if (!color1Valid || !color2Valid) return;
                
                const ratio = ratio1.value / 100;
                
                // 将HEX转换为RGB
                const color1Rgb = hexToRgb(color1.value);
                const color2Rgb = hexToRgb(color2.value);
                
                // 计算混合后的RGB值
                const mixedRgb = {
                    r: Math.round(color1Rgb.r * ratio + color2Rgb.r * (1 - ratio)),
                    g: Math.round(color1Rgb.g * ratio + color2Rgb.g * (1 - ratio)),
                    b: Math.round(color1Rgb.b * ratio + color2Rgb.b * (1 - ratio))
                };
                
                // 显示结果
                const mixedHex = rgbToHex(mixedRgb.r, mixedRgb.g, mixedRgb.b);
                mixedColor.style.backgroundColor = mixedHex;
                rgbValue.textContent = `${mixedRgb.r}, ${mixedRgb.g}, ${mixedRgb.b}`;
                hexValue.textContent = mixedHex;
            }
            
            // 辅助函数：HEX转RGB
            function hexToRgb(hex) {
                const r = parseInt(hex.substring(1, 3), 16);
                const g = parseInt(hex.substring(3, 5), 16);
                const b = parseInt(hex.substring(5, 7), 16);
                return { r, g, b };
            }
            
            // 辅助函数：RGB转HEX
            function rgbToHex(r, g, b) {
                return '#' + [r, g, b].map(x => {
                    const hex = x.toString(16);
                    return hex.length === 1 ? '0' + hex : hex;
                }).join('');
            }
            
            // 初始计算
            updateSliders();
        });
    </script>
</body>
</html>